library(phangorn)
library(cluster)
source("../../topclustMDS.R")
source("../../gapCR.R")

trs <- read.tree("selection.55tips.336.tre")

trsmds <- topoclustMDS(trs, mdsdim = 2, max.k = 20)

bestNclust <- gapCR(trsclust[[3]]$Tab[, 3], trsclust[[3]]$Tab[, 4])

trsclust <- pam(trsmds[[2]]$points, k = bestNclust)

save(trsmds, trsclust, bestNclust, file = "selection.clustering.55tips.336.Rdata")